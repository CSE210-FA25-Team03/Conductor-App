<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Work Journal | Conductor</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
    <header class="top-nav">
        <div class="brand">Conductor <span>App</span></div>
        <div class="nav-actions" style="display:flex;align-items:center;gap:1.2rem;">
            <a href="#" id="backDashboard" class="back-btn">‚Üê Back to Dashboard</a>
            <div class="profile">
                <a href="/profile_page/profile.html" class="profile-link">
                    <div class="profile-dropdown-container" style="position:relative;">
                        <img id="dashboardProfileImg" src="/assets/logo/user.png" alt="Profile" style="width:44px;height:44px;border-radius:50%;object-fit:cover;cursor:pointer;" />
                        <div class="profile-dropdown" id="profileDropdown" style="display:none; position:absolute; top:48px; right:0; background:#fff; border:1px solid #ddd; border-radius:8px; box-shadow:0 2px 8px rgba(0,0,0,0.08); min-width:140px; z-index:10;">
                            <a href="/profile_page/profile.html" style="display:block; padding:10px 16px; color:#222; text-decoration:none;">Profile</a>
                            <a href="#" id="logoutBtn" style="display:block; padding:10px 16px; color:#d00; text-decoration:none;">Log Out</a>
                        </div>
                    </div>
                </a>
            </div>
        </div>
    </header>

    <section class="work-journal-container">
        <h2 class="wj-title">Daily Work Journal Form</h2>

        <form id="workJournalForm" class="wj-form">

            <!-- What did you do -->
            <div class="wj-field">
            <label for="tasksDone">What did you work on today?</label>
            <textarea id="tasksDone" placeholder="Describe what you completed, what you're working on, or anything you want to share..." required></textarea>
            </div>

            <!-- Emotional sentiment -->
            <div class="wj-field">
            <label>How are you feeling?</label>
            <div class="sentiment-options">
                <label><input type="radio" name="sentiment" value="üòÄ Great"> üòÄ Great</label>
                <label><input type="radio" name="sentiment" value="üôÇ Good"> üôÇ Good</label>
                <label><input type="radio" name="sentiment" value="üòê Okay"> üòê Okay</label>
                <label><input type="radio" name="sentiment" value="üòü Stressed"> üòü Stressed</label>
                <label><input type="radio" name="sentiment" value="üò´ Overwhelmed"> üò´ Overwhelmed</label>
            </div>

            <textarea id="sentimentNotes" placeholder="Optional: Want to elaborate on your mood?"></textarea>
            </div>

            <!-- Reach out -->
            <div class="wj-field">
            <label for="reachOut">Do you need to reach out to someone?</label>
            <select id="reachOut">
                <option value="">No, I'm good</option>
                <option value="team_lead">Team Lead</option>
                <option value="ta">Teaching Assistant</option>
                <option value="professor">Professor</option>
            </select>
            <textarea id="reachOutMessage" placeholder="Optional: Write a message you'd like them to see..."></textarea>
            </div>

            <!-- Repo link -->
            <div class="wj-field">
            <label for="repoLink">GitHub repo (optional)</label>
            <input type="url" id="repoLink" placeholder="https://github.com/yourproject/commit/...">
            </div>

            <!-- Attachments (optional) -->
            <div class="wj-field">
            <label>Attach files or screenshots (optional)</label>
            <input type="file" id="wjFiles" multiple>
            </div>

            <!-- Submit -->
            <div class="wj-submit">
            <button type="submit" class="wj-btn">Submit Journal Entry</button>
            </div>

        </form>

        <div id="wjSuccess" class="wj-success" style="display:none;">
            ‚úî Your journal has been submitted!
        </div>
        <script>
            // Hide the success message after 6 seconds
            document.addEventListener('DOMContentLoaded', function() {
            const wjSuccess = document.getElementById("wjSuccess");
            document.getElementById("workJournalForm").addEventListener("submit", function() {
                if (wjSuccess) {
                wjSuccess.style.display = "block";
                setTimeout(() => {
                    wjSuccess.style.display = "none";
                }, 5000);
                }
            });
            });
        </script>
    </section>

    <section class="profile-panel" id="profile-panel" aria-hidden="true">
    <!-- Profile panel removed, navigation now goes to profile page -->

    <script src="script.js"></script>
        <script>
            // Profile dropdown logic
            const profileImg = document.getElementById('dashboardProfileImg');
            const dropdown = document.getElementById('profileDropdown');
            if (profileImg && dropdown) {
                profileImg.addEventListener('mouseenter', () => {
                    dropdown.style.display = 'block';
                });
                profileImg.addEventListener('mouseleave', () => {
                    setTimeout(() => {
                        if (!dropdown.matches(':hover')) dropdown.style.display = 'none';
                    }, 150);
                });
                dropdown.addEventListener('mouseleave', () => {
                    dropdown.style.display = 'none';
                });
                dropdown.addEventListener('mouseenter', () => {
                    dropdown.style.display = 'block';
                });
                document.getElementById('logoutBtn').addEventListener('click', function(e) {
                    e.preventDefault();
                    localStorage.clear();
                    window.location.href = '/login';
                });
            }
        </script>
        <script>
            window.addEventListener('DOMContentLoaded', function() {
                var savedImg = localStorage.getItem('profileImg');
                if (savedImg) {
                    var img1 = document.getElementById('dashboardProfileImg');
                    if (img1) img1.src = savedImg;
                }
            });
        </script>
        <script>
            window.addEventListener('DOMContentLoaded', function() {
                var firstName = localStorage.getItem('firstName') || 'Avery';
                var lastName = localStorage.getItem('lastName') || 'Lin';
                var role = localStorage.getItem('role') || 'Professor';
                var email = localStorage.getItem('email') || 'avery.lin@conductor.edu';
                document.getElementById('profName').textContent = firstName + ' ' + lastName;
                document.getElementById('profFullName').textContent = firstName + ' ' + lastName;
                document.getElementById('profRole').textContent = role + ' ¬∑ CSE 210';
                document.getElementById('profRoleMeta').textContent = role;
                document.getElementById('profEmail').textContent = email;
            });
        </script>

        <script>
        // Dynamic dashboard link based on role
        document.getElementById('backDashboard').addEventListener('click', function(e) {
            e.preventDefault();
            var role = localStorage.getItem('role');
            if (role === 'professor') {
                window.location.href = '/dashboards/professor.html';
            } else if (role === 'Teaching Assistant') {
                window.location.href = '/dashboards/ta.html';
            } else if (role === 'team_lead') {
                window.location.href = '/dashboards/team_lead.html';
            } else {
                window.location.href = '/dashboards/student.html';
            }
        });
        </script>

        <script>
        document.getElementById("workJournalForm").addEventListener("submit", function(e) {
            e.preventDefault();

            const entry = {
                tasksDone: document.getElementById("tasksDone").value,
                sentiment: document.querySelector("input[name='sentiment']:checked")?.value || "",
                sentimentNotes: document.getElementById("sentimentNotes").value,
                reachOut: document.getElementById("reachOut").value,
                reachOutMessage: document.getElementById("reachOutMessage").value,
                repoLink: document.getElementById("repoLink").value,
                date: new Date().toISOString()
            };

            // Save locally (or send to server)
            let journal = JSON.parse(localStorage.getItem("workJournal") || "[]");
            journal.push(entry);
            localStorage.setItem("workJournal", JSON.stringify(journal));

            // Handle contact
            if (entry.reachOut) {
                console.log("Need to notify:", entry.reachOut, entry.reachOutMessage);
                // integrations with email/slack/chatbot can go here
            }

            // Show success
            document.getElementById("wjSuccess").style.display = "block";

            // Clear form
            this.reset();
        });
        </script>

    
</body>
</html>
